<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=ns-m2xQYezAtqh7ai59hJbf4StG0Hm_q2rzPY0wvvg52HUEZEgyMHTxRy8a4hUrdPEgRjQ7SmZp8loyNcwuo40S781hFqMHj_gciLL2h846-jfeThp0NQsMQ1FNpPEEL');ol{margin:0;padding:0}table td,table th{padding:0}.c6{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:20pt;font-family:"Ubuntu";font-style:normal}.c18{color:#666666;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:18pt;font-family:"Ubuntu Condensed";font-style:normal}.c15{color:#666666;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:18pt;font-family:"Ubuntu";font-style:normal}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left;height:11pt}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Ubuntu";font-style:normal}.c17{color:#000000;text-decoration:none;vertical-align:baseline;font-size:26pt;font-family:"Ubuntu Condensed";font-style:normal}.c3{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c13{color:#000000;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Ubuntu";font-style:normal}.c16{padding-top:0pt;padding-bottom:3pt;line-height:1.15;page-break-after:avoid;text-align:center}.c7{padding-top:0pt;padding-bottom:16pt;line-height:1.15;page-break-after:avoid;text-align:center}.c4{padding-top:16pt;padding-bottom:4pt;line-height:1.15;page-break-after:avoid;text-align:left}.c14{padding-top:18pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;text-align:left}.c1{padding-top:20pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;text-align:left}.c11{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c9{color:inherit;text-decoration:inherit}.c5{color:#1155cc;text-decoration:underline}.c12{font-weight:400;font-family:"Droid Sans Mono"}.c8{font-style:italic}.c10{font-weight:700}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Ubuntu Condensed";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:center}.subtitle{padding-top:0pt;color:#666666;font-size:18pt;padding-bottom:16pt;font-family:"Ubuntu Condensed";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:center}li{color:#000000;font-size:11pt;font-family:"Ubuntu"}p{margin:0;color:#000000;font-size:11pt;font-family:"Ubuntu"}h1{padding-top:20pt;color:#000000;font-weight:700;font-size:20pt;padding-bottom:6pt;font-family:"Ubuntu";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#666666;font-size:18pt;padding-bottom:6pt;font-family:"Ubuntu";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#000000;font-weight:700;font-size:14pt;padding-bottom:4pt;font-family:"Ubuntu";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Ubuntu";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Ubuntu";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Ubuntu";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c11"><p class="c16 title" id="h.zdkp5m1b6848"><span>Web </span><span class="c10 c17">- Week 6</span></p><p class="c7 subtitle" id="h.4bczn7ey4uxc"><span>Inputs / Physics</span></p><p class="c0"><span class="c2"></span></p><h1 class="c1" id="h.gsrhr28aaepn"><span class="c6">Review</span></h1><p class="c3"><span>Last week we learned all about images. Starting with loading and drawing a single image, we then wrote a promise based image loader to easily draw multiple images. We then took the image loader and combined it with the Giphy API to create a basic image search. Finally, you chose a character and created an animation system that allows your character to perform a variety of actions.</span></p><h1 class="c1" id="h.x5by05ypmqd0"><span class="c6">Delta Time</span></h1><p class="c3"><span>One issue most of you experienced is lag within your animations. This lag wasn&rsquo;t mainly due to low frame rate, but instead caused by an inconsistent frame rate. When your frame rate is fluctuating, so is the speed of your animation, making it appear unsmooth and inconsistent. To fix this, we&rsquo;ll need to use </span><span class="c10">delta time</span><span class="c2">.</span></p><h3 class="c4" id="h.z6rzimvs3h3v"><span>Exercise #1 - </span><span class="c5"><a class="c9" href="https://www.google.com/url?q=http://pastebin.com/tkXSptVf&amp;sa=D&amp;ust=1487022911363000&amp;usg=AFQjCNEuuLeam6zEu8-PBG21SnthUXvD4g">http://pastebin.com/tkXSptVf</a></span></h3><p class="c3"><span>In this demo, we&rsquo;re going to break down exactly </span><span class="c8">why</span><span>&nbsp;delta time is needed, and </span><span class="c8">how</span><span class="c2">&nbsp;we can use it. We&rsquo;ll do this by comparing a square updating at 30 FPS to a square updating at 15 FPS. To fix this, we&rsquo;ll multiply the movement speed by the time elapsed between updates, we can make both squares move in-sync with each other.</span></p><p class="c0"><span class="c2"></span></p><p class="c3"><span>To use this dynamically in our game where the FPS is fluctuating, we&rsquo;ll use the time parameter passed in by the </span><span class="c12">requestAnimationFrame</span><span class="c2">&nbsp;function.</span></p><h3 class="c4" id="h.cmxecv9aogid"><span>Exercise #2 - </span><span class="c5"><a class="c9" href="https://www.google.com/url?q=http://pastebin.com/hqnW4Hdq&amp;sa=D&amp;ust=1487022911366000&amp;usg=AFQjCNFqYAaWGyq_fO4DcJgPjFnDcLVq8w">http://pastebin.com/hqnW4Hdq</a></span></h3><p class="c3"><span>As you can see, we use the same principles from the delta demo in our game. We take the current time and subtract the previous time to get the time passed (or delta) between frames. We&rsquo;ll then multiply this by our animation ticks with the goal of achieving 60 FPS.</span></p><h1 class="c1" id="h.va1qt94s07u9"><span class="c6">Inputs</span></h1><p class="c3"><span class="c2">Now that we&rsquo;ve got our animations smoothed out, we can start hooking up inputs for changing our different states/animations.</span></p><h2 class="c14" id="h.kqn5enn1z8b1"><span class="c15">Set State</span></h2><p class="c3"><span class="c2">Currently, we have no way of changing our player&rsquo;s animation state live. We could try simply changing the state variable, but as you&rsquo;ll see, it doesn&rsquo;t reset the current frame or update the image. Because of this, we&rsquo;ll create a small function to do this for us.</span></p><h3 class="c4" id="h.ifbn6jqy8ztx"><span>Exercise #3 - </span><span class="c5"><a class="c9" href="https://www.google.com/url?q=http://pastebin.com/B1DDkAaf&amp;sa=D&amp;ust=1487022911369000&amp;usg=AFQjCNFqJ6gG5LItCPAOoSRsGSiP6mrpMA">http://pastebin.com/B1DDkAaf</a></span></h3><p class="c3"><span class="c2">We&rsquo;re not doing anything complicated here. All we&rsquo;ve done is make a function to update all the necessary variables and image to our new animation state.</span></p><h2 class="c14" id="h.tp86l5lo0sqs"><span class="c15">Keyboard</span></h2><p class="c3"><span class="c2">Being able to easily change the state is great, but let&rsquo;s hook it up to keyboard events.</span></p><h3 class="c4" id="h.5lsgsi9aeg8w"><span>Exercise #4 - </span><span class="c5"><a class="c9" href="https://www.google.com/url?q=http://pastebin.com/qTx5ezMM&amp;sa=D&amp;ust=1487022911371000&amp;usg=AFQjCNEkw0jsuTVNosQgO0auHOOZZh-qBw">http://pastebin.com/qTx5ezMM</a></span></h3><p class="c3"><span class="c2">Like every other event in JavaScript, we use an eventListener to wait for and act on keypresses. In this case, we create a keysPressed array which will contain all the keys pressed within the last frame. Then, inside of the update function, we set the player state to jump if the spacebar is one of the pressed keys.</span></p><p class="c0"><span class="c2"></span></p><p class="c3"><span class="c2">Try changing the key for jump, or adding additional keys for other player states.</span></p><h1 class="c1" id="h.mqio2yrhea69"><span class="c6">Gravity</span></h1><p class="c3"><span class="c2">We can now change our player&rsquo;s animation with the keyboard, but he still doesn&rsquo;t move. To incorporate movement, and more specifically, jumping, we&rsquo;ll need to have a very basic understanding of gravity, acceleration, and velocity.</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 468.00px;"><img alt="" src="images/image00.jpg" style="width: 624.00px; height: 468.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span>This picture demonstrates that </span><span class="c10">force</span><span>&nbsp;</span><span class="c10">= mass *</span><span>&nbsp;</span><span class="c10">acceleration</span><span class="c2">, and how that plays out during a jump. When our character jumps, we&rsquo;ll give him an initial positive force to move upwards, then the only force acting on him will be gravity pulling him back down. You don&rsquo;t need to worry about the specific amounts of force or mass, we&rsquo;ll make those numbers up in the context of our game. The only thing here we need to calculate is the acceleration.</span></p><p class="c0"><span class="c2"></span></p><p class="c3"><span>Once we have the acceleration, we&rsquo;ll add that to our velocity. </span><span class="c10">Velocity</span><span>&nbsp;is our speed in a given direction. So in the case of our game, a velocity of 10 would mean move </span><span class="c8">up</span><span>&nbsp;10 pixels. While a velocity of -10 would imply moving </span><span class="c8">down</span><span class="c2">&nbsp;10 pixels.</span></p><p class="c0"><span class="c2"></span></p><p class="c3"><span class="c2">After calculating the velocity, we&rsquo;ll simply add that to our player&rsquo;s y position. Once we&rsquo;ve taken care of all the nasty physics, we just have to worry about when to apply them and when to let our player be. For this we&rsquo;ll create a condition that will check if the bottom of our player is going to collide with the top of the ground. If there will be a collision, we&rsquo;ll set the state back to running (or idle), make sure he&rsquo;s at the exact height of the ground, and set our velocity back to zero.</span></p><p class="c0"><span class="c2"></span></p><p class="c3"><span class="c2">Then, as soon as our player jumps again and the initial force is added, we&rsquo;ll do it all over again.</span></p><p class="c0"><span class="c2"></span></p><p class="c3"><span class="c2">Let&rsquo;s add these new methods and variables to our player.</span></p><h3 class="c4" id="h.x2xjyt64502s"><span>Exercise #5 - </span><span class="c5"><a class="c9" href="https://www.google.com/url?q=http://pastebin.com/3ZWHSHh3&amp;sa=D&amp;ust=1487022911378000&amp;usg=AFQjCNGVmySUtlrsqgEGleuDiHdBNvrJGg">http://pastebin.com/3ZWHSHh3</a></span></h3><p class="c3"><span class="c2">We&rsquo;ve added quite a bit of code in this exercise, all which directly reflects what we just learned about gravity, acceleration, and velocity. There&rsquo;s a bit of extra math in our actual code, which is there to smooth out the rough edges of an inconsistent frame rate. You may also notice that we multiply by delta to ensure our game plays the same across varying FPS.</span></p><p class="c0"><span class="c2"></span></p><p class="c3"><span>There&rsquo;s a lot of room here to change how your player jumps. Try changing the force of gravity, your player&rsquo;s mass, and the initial jump force.</span></p><h1 class="c1" id="h.vz7xxlcijafp"><span class="c6">Score</span></h1><p class="c3"><span class="c2">Our game wouldn&rsquo;t be much fun without a score to track our progress, so let&rsquo;s add a score display.</span></p><h3 class="c4" id="h.maxcs66z9mul"><span>Exercise #6 - </span><span class="c5"><a class="c9" href="https://www.google.com/url?q=http://pastebin.com/B6gy6yqF&amp;sa=D&amp;ust=1487022911381000&amp;usg=AFQjCNFzxdHtvm6VqFVKGK-29WeZRVaxdA">http://pastebin.com/B6gy6yqF</a></span></h3><p class="c3"><span class="c2">Displaying the score may look more complicated that it really is. In fact, the majority of our score function is simply setting up variables so that we can draw the updated score.</span></p><p class="c0"><span class="c2"></span></p><p class="c3"><span class="c2">You may find the score looks slightly uninspired, so try changing the font type, size, color, and position, all on line 252 where you create the score object.</span></p><h2 class="c14" id="h.yv5bmyghlou6"><span class="c15">Google fonts</span></h2><p class="c3"><span class="c2">If you want your score to look even better or more original, choose a font from Google Fonts, link it in your canvas.html, and change the font name in your score declaration.</span></p></body></html>